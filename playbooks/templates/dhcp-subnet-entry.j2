
subnet {{ p_network }} netmask {{ p_netmask }} {
  
    option domain-name         "{{ p_cluster }}.{{ p_domain }}";
    option domain-name-servers {{ p_dns }};
    option routers             {{ p_gateway }};
    option broadcast-address   {{ p_broadcast }};
{%if p_ntp is defined and p_ntp|length %}
    option ntp-servers         {{ p_ntp }};
{% endif %}

{% if g_usePXE == 'True' %}
  class "pxeclients" {	

    match if substring (option vendor-class-identifier, 0, 9) = "PXEClient";

    next-server {{ p_nextsvr }};

    if exists user-class and option user-class = "iPXE" {

      ## If client supports iPXE

      ## BOOT.IPXE - is a *magic* file dynamically 
      ##             generated by matchboxd running on p_nextsvr

      filename "http://{{ p_nextsvr }}:8080/boot.ipxe";

    } elsif option client-system-arch = 00:07 or option client-system-arch = 00:09 {

      ## If client is UEFI, chainload an iPXE capable client, retry

      filename "ipxe-x86_64.efi";

    } else {

      ## If client is UEFI, chainload an iPXE capable client, retry
      ##

      filename "undionly.kpxe";
    } 
  }
{% endif %}
}

